trigger:
  branches:
    include:
      - main

stages:
- stage: Dev
  jobs:
    - job: Terraform_Dev
      steps:
        - script: terraform apply ...

- stage: PreProd
  dependsOn: Dev
  condition: succeeded()
  approval:
    approvals:
      - reviewers: [ "team-lead" ]
  jobs:
    - job: Terraform_PreProd
      steps:
        - script: terraform apply ...

- stage: Prod
  dependsOn: PreProd
  condition: succeeded()
  approval:
    approvals:
      - reviewers: [ "cto" ]
  jobs:
    - job: Terraform_Prod
      steps:
        - script: terraform apply ...
